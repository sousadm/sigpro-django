<script>

</script>

{% extends "core/base.html" %}
{% load bootstrap %}
{% load static %}
{% block title %} Pessoa {% endblock %}

{% block content %}

<div class="container">
    <form method="post">

        <input type="hidden" name="clienteId" value={{ form.clienteId.value }}>
        <input type="hidden" name="vendedorId" value={{ form.vendedorId.value }}>
        <input type="hidden" name="transportadorId" value={{ form.transportadorId.value }}>
        <input type="hidden" name="fornecedorId" value={{ form.fornecedorId.value }}>
        <input type="hidden" name="situacaoPessoa" value={{ form.situacaoPessoa.value }}>

        {% csrf_token %}

        <fieldset {% if not form.situacaoPessoa.value %} disabled {% endif %}>

            <div class="card">
                <div class="card-header">
                    <h3>Cadastro de Pessoa</h3>
                </div>
                <div class="card-body">

                    <div class="row">
                        <div class="col-12 col-md-2">
                            <label class="control-label">CÃ³digo</label>
                            <input type="number" disabled="disabled" class="form-control" value={{form.pessoaId.value}}>
                        </div>
                        <div class="col-12 col-md-10">
                            {{ form.nome|bootstrap }}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 col-md-3">
                            {{ form.fone|bootstrap }}
                        </div>
                        <div class="col-12 col-md-7">
                            {{ form.email|bootstrap }}
                        </div>
                        <div class="col-12 col-md-2">
                            <label>Tipo de Pessoa</label>
                            <select name="tipoPessoa" id="tipoPessoa" class="form-control"
                                    onchange="selecionaTipoChange(this)">
                                {% for choice in form.tipoPessoa.field.choices %}
                                <option value="{{ choice.0 }}" {% if choice.0 == tipo_selected %} selected {% endif %}>
                                    {{ choice.1 }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row" id="fisica">

                        <div class="col-12 col-md-2">
                            {{ form.cpf|bootstrap }}
                        </div>
                        <div class="col-12 col-md-2">
                            {{ form.identidade|bootstrap }}
                        </div>
                        <div class="col-12 col-md-3">
                            {{ form.emissao|bootstrap }}
                        </div>
                        <div class="col-12 col-md-2">
                            {{ form.orgao|bootstrap }}
                        </div>
                        <div class="col-12 col-md-3">
                            {{ form.idEstrangeiro|bootstrap }}
                        </div>

                        <div class="col-12 col-md-2">
                            {{ form.nascimento|bootstrap }}
                        </div>
                        <div class="col-12 col-md-5">
                            {{ form.pai|bootstrap }}
                        </div>
                        <div class="col-12 col-md-5">
                            {{ form.mae|bootstrap }}
                        </div>

                        <div class="col-12 col-md-6">
                            {{ form.nacionalidade|bootstrap }}
                        </div>
                        <div class="col-12 col-md-6">
                            {{ form.naturalidade|bootstrap }}
                        </div>

                    </div>

                    <div class="row" id="juridica">
                        <div class="col-12 col-md-4">
                            {{ form.cnpj|bootstrap }}
                        </div>
                        <div class="col-12 col-md-8">
                            {{ form.fantasia|bootstrap }}
                        </div>
                        <div class="col-12 col-md-3">
                            {{ form.IE|bootstrap }}
                        </div>
                        <div class="col-12 col-md-3">
                            {{ form.cnae|bootstrap }}
                        </div>
                        <div class="col-12 col-md-3">
                            {{ form.fundacao|bootstrap }}
                        </div>
                        <div class="col-12 col-md-3">
                            {{ form.incentivoCultural|bootstrap }}
                        </div>
                        <div class="col-12 col-md-6">
                            {{ form.regime|bootstrap }}
                        </div>
                        <div class="col-12 col-md-6">
                            {{ form.tipoIE|bootstrap }}
                        </div>
                    </div>

                </div>
            </div>

        </fieldset>

        <div class="footer bg-blue">

            <button type="submit" value="btn_novo" name="btn_novo" class="btn">
                <i class="fa fa-file"></i> Novo
            </button>
            <a href="{% url 'url_pessoa_list' %}">
                <button type="button" class="btn">
                    <i class="fas fa-edit"></i> Lista
                </button>
            </a>

            {% if form.situacaoPessoa.value %}
            <button type="submit" value="btn_salvar" name="btn_salvar" class="btn btn-primary">
                <i class="fas fa-save"></i> Salvar
            </button>
            {% if form.existe %}
            <button type="submit" value="btn_cliente" name="btn_cliente"
                    title="{{form.clienteId.value}}" class="btn btn-secondary">
                <i class="fas fa-user"></i> Cliente
            </button>
            <button type="submit" value="btn_cliente" name="btn_fornecedor"
                    title="{{form.fornecedorId.value}}" class="btn btn-secondary">
                <i class="fas fa-building"></i> Fornecedor
            </button>
            <button type="submit" value="btn_transportador" name="btn_transportador"
                    title="{{form.transportadorId.value}}" class="btn btn-secondary">
                <i class="fas fa-car"></i> Transportador
            </button>
            <button type="submit" value="btn_vendedor" name="btn_vendedor"
                    title="{{form.vendedorId.value}}" class="btn btn-secondary">
                <i class="fas fa-vcard"></i> Vendedor
            </button>
            {% endif %}
            {% endif %}

            {% if form.existe %}
            <button type="submit" value="btn_ativar" name="btn_ativar" class="btn btn-danger"
                    onClick='return confirma("Confirma {%if form.situacaoPessoa.value%} Inativar {%else%} Ativar {%endif%} o registro atual?")'>
                <i class="fas fa-check"></i> {%if form.situacaoPessoa.value%} Inativar {%else%} Ativar {%endif%}
            </button>
            {% endif %}

        </div>

    </form>
</div>

<script>

    document.addEventListener('DOMContentLoaded', function() {
        var sel = document.getElementById('tipoPessoa');
        selecionaTipoChange(sel);
    });

    function selecionaTipoChange(sel) {

        var element_fisica = document.getElementById('fisica');
        element_fisica.style.display = sel.value == 'FISICA' ? 'flex' : 'none';

        var element_juridica = document.getElementById('juridica');
        element_juridica.style.display = sel.value == 'JURIDICA' ? 'flex' : 'none';

        //document.getElementById('id_tipoPessoa') = sel.value;

    }


</script>

{% endblock %}